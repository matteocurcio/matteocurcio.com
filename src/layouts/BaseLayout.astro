---
import "../styles/global.css";
import { CONTACT_MAILTO, SITE_CONFIG } from "../config/site";

interface Props {
  title: string;
  description?: string;
  path?: string;
  navSection?: "works" | "reels" | "about" | "services" | "tutoring" | "blog";
}

const {
  title,
  description = "Portfolio of Matteo Curcio. Finishing, motion, editorial, tutoring, and studio workflow consulting.",
  path = "/",
  navSection
} = Astro.props;

const canonical = new URL(path, Astro.site);
const schema = {
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Person",
      name: SITE_CONFIG.ownerName,
      email: SITE_CONFIG.contactEmail,
      url: `https://${SITE_CONFIG.primaryDomain}`
    },
    {
      "@type": "Organization",
      name: SITE_CONFIG.ownerName,
      email: SITE_CONFIG.contactEmail,
      url: `https://${SITE_CONFIG.primaryDomain}`
    }
  ]
};

const socialLinks = [
  { label: "LinkedIn", href: SITE_CONFIG.social.linkedin, icon: "/icons/social/linkedin.svg" },
  { label: "GitHub", href: SITE_CONFIG.social.github, icon: "/icons/social/github.svg" },
  { label: "Instagram", href: SITE_CONFIG.social.instagram, icon: "/icons/social/instagram.svg" },
  { label: "Pinterest", href: SITE_CONFIG.social.pinterest, icon: "/icons/social/pinterest.svg" },
  { label: "YouTube", href: SITE_CONFIG.social.youtube, icon: "/icons/social/youtube.svg" }
];
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="canonical" href={canonical.href} />
    <meta property="og:type" content="website" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonical.href} />
    <meta property="og:site_name" content={SITE_CONFIG.ownerName} />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:site" content={SITE_CONFIG.social.x} />
    <script type="application/ld+json" set:html={JSON.stringify(schema)} />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,400;9..144,500;9..144,600&family=Manrope:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body data-path={path}>
    <header class="site-header">
      <div class="shell nav">
        <a class="brand" href="/" aria-label="Matteo Curcio home">
          <span class="brand-wheel" aria-hidden="true">
            <svg class="brand-wheel-icon" viewBox="0 0 16.58 16.58" xmlns="http://www.w3.org/2000/svg" focusable="false">
              <g transform="matrix(0.427673 0.903933 -0.903933 0.427673 -15.733518 -62.112824)">
                <path d="M72.54,13.5l-.71,2.66c1.35.38,2.82.41,4.27.02l-.71-2.66c-.97.27-1.95.24-2.85-.02Z" fill="#0291cd" />
                <path d="M70.12,12.05L68.18,14c1,1.03,2.27,1.79,3.65,2.17l.71-2.66c-.92-.27-1.76-.77-2.42-1.46Z" fill="#0247fe" />
                <path d="M75.39,13.53l.71,2.66c1.45-.39,2.71-1.15,3.69-2.15l-1.95-1.95c-.66.67-1.49,1.18-2.45,1.44Z" fill="#66b132" />
                <path d="M77.84,12.09l1.95,1.95c1.01-1.03,1.73-2.31,2.08-3.71L79.2,9.62c-.22.93-.7,1.78-1.36,2.47Z" fill="#d0e92b" />
                <path d="M81.79,6.11l-2.66.71c.01.05.03.1.05.15.24.9.24,1.8.03,2.64l2.66.71c.33-1.29.34-2.69-.03-4.07-.02-.04-.04-.09-.05-.14Z" fill="#fffe32" />
                <path d="M68.83,9.75c-.01-.05-.02-.1-.03-.15l-2.66.71c.01.05.02.1.04.15.37,1.38,1.08,2.58,2.01,3.54l1.95-1.95c-.62-.63-1.07-1.41-1.31-2.3Z" fill="#3e01a4" />
                <path d="M77.69,4.49l1.95-1.95c-1.01-.97-2.26-1.67-3.61-2.02l-.71,2.66c.88.22,1.7.67,2.37,1.31Z" fill="#fb9902" />
                <path d="M75.31,3.17l.71-2.66c-1.31-.34-2.72-.36-4.12.02l.71,2.66c.92-.25,1.84-.24,2.7-.02Z" fill="#fd5308" />
                <path d="M79.12,6.83l2.66-.71c-.41-1.41-1.16-2.63-2.15-3.58L77.68,4.49c.66.62,1.17,1.41,1.44,2.34Z" fill="#f9bc02" />
                <path d="M68.87,6.85L66.2,6.13c-.38,1.32-.42,2.75-.07,4.18L68.8,9.6c-.23-.94-.19-1.88.07-2.75Z" fill="#8601b0" />
                <path d="M72.61,3.19L71.9,0.53c-1.4.38-2.61,1.1-3.58,2.04l1.95,1.95c.63-.62,1.43-1.09,2.34-1.33Z" fill="#fe2712" />
                <path d="M70.27,4.52L68.32,2.57c-1,.98-1.73,2.21-2.12,3.56l2.67.71c.26-.87.74-1.68,1.4-2.32Z" fill="#a7194b" />
              </g>
            </svg>
          </span>
          <span class="brand-wordmark"><span class="brand-first">matteo</span> <span class="brand-last">curcio</span></span>
        </a>
        <button class="nav-toggle" type="button" aria-label="Toggle menu" aria-expanded="false" aria-controls="site-nav" data-nav-toggle>
          <span></span>
          <span></span>
          <span></span>
        </button>
        <nav class="nav-links" id="site-nav" aria-label="Main" data-nav-links>
          <a href="/about" aria-current={path === "/about" ? "page" : undefined}>About</a>
          <a href="/works" aria-current={(navSection ? navSection === "works" : path === "/works" || path === "/work" || path.startsWith("/projects")) ? "page" : undefined}>Projects</a>
          <a href="/reels" aria-current={(navSection ? navSection === "reels" : path === "/reels") ? "page" : undefined}>Reels</a>
          <a href="/services" aria-current={path === "/services" ? "page" : undefined}>Services</a>
          <a href="/tutoring" aria-current={path === "/tutoring" ? "page" : undefined}>TUTORING</a>
          <a href="/blog" aria-current={path.startsWith("/blog") ? "page" : undefined}>Blog</a>
        </nav>
      </div>
    </header>
    <main>
      <div class="shell">
        <slot />
      </div>
    </main>
    <footer class="site-footer">
      <div class="shell site-footer-grid">
        <p class="site-footer-left">Â© 2026 <a href={CONTACT_MAILTO} target="_self" rel="noopener">{SITE_CONFIG.ownerName}</a></p>
        <nav class="site-footer-social" aria-label="Social links">
          {socialLinks.map((social) => (
            <a href={social.href} target="_blank" rel="noopener noreferrer" aria-label={social.label} title={social.label}>
              <img src={social.icon} alt="" aria-hidden="true" loading="lazy" />
            </a>
          ))}
        </nav>
        <div class="site-footer-right-wrap">
          <p class="site-footer-right">Designed on the stolen lands of the <br /><a href="https://en.wikipedia.org/wiki/Wurundjeri" target="_blank" rel="noopener noreferrer">Wurundjeri Woi Wurrung</a> people of the <a href="https://en.wikipedia.org/wiki/Kulin_nation" target="_blank" rel="noopener noreferrer">Kulin Nation</a>.<br />Sovereignty was never ceded.</p>
          <svg class="aboriginal-flag" viewBox="0 0 14 9" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Australian Aboriginal Flag">
            <rect x="0" y="0" width="14" height="4.5" fill="#000000" />
            <rect x="0" y="4.5" width="14" height="4.5" fill="#e00000" />
            <circle cx="7" cy="4.5" r="2.3" fill="#ffd300" />
          </svg>
        </div>
      </div>
    </footer>
    <script is:inline>
      const siteHeader = document.querySelector(".site-header");
      const navToggle = document.querySelector("[data-nav-toggle]");
      const navLinks = document.querySelector("[data-nav-links]");

      if (siteHeader && navToggle && navLinks) {
        const setMenuState = (isOpen) => {
          navToggle.setAttribute("aria-expanded", isOpen ? "true" : "false");
          siteHeader.classList.toggle("is-nav-open", isOpen);
        };

        navToggle.addEventListener("click", () => {
          const open = navToggle.getAttribute("aria-expanded") === "true";
          setMenuState(!open);
        });

        navLinks.querySelectorAll("a").forEach((link) => {
          link.addEventListener("click", () => setMenuState(false));
        });

        document.addEventListener("click", (event) => {
          if (!(event.target instanceof Node)) return;
          if (!siteHeader.contains(event.target)) {
            setMenuState(false);
          }
        });

        document.addEventListener("keydown", (event) => {
          if (event.key === "Escape") setMenuState(false);
        });

        window.addEventListener("resize", () => {
          if (window.innerWidth > 980) {
            setMenuState(false);
          }
        });
      }

      const cards = document.querySelectorAll("[data-hover-preview='true']");
      cards.forEach((card) => {
        const video = card.querySelector("video");
        if (!video) return;

        const play = () => {
          video.play().catch(() => {});
        };

        const stop = () => {
          video.pause();
          video.currentTime = 0;
        };

        card.addEventListener("mouseenter", play);
        card.addEventListener("mouseleave", stop);
        card.addEventListener("focusin", play);
        card.addEventListener("focusout", stop);
      });
    </script>
  </body>
</html>
