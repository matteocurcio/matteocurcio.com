---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import { LEGACY_REELS } from "../data/legacyPortfolio";

const projects = await getCollection("projects");
const available = new Set(projects.map((p) => p.slug));
---

<BaseLayout title="Reels | Matteo Curcio" path="/reels">
  <section class="reels-grid" aria-label="Reel categories">
    {LEGACY_REELS.map((item) => {
      const link = available.has(item.slug) ? `/projects/${item.slug}/` : undefined;
      return link ? (
        <a class="reel-tile" href={link} aria-label={item.title}>
          <div class="reel-media" data-hover-preview={item.video ? "true" : undefined}>
            <img src={item.image} alt={item.title} loading="lazy" />
            {item.video ? (
              <video class="reel-preview" src={item.video} muted loop playsinline preload="none" aria-hidden="true" />
            ) : null}
          </div>
          <div class="reel-overlay">
            <p class="reel-brand"><span class="reel-dot" aria-hidden="true"></span>matteocurcio</p>
            <p class="reel-title">{item.title}</p>
          </div>
        </a>
      ) : (
        <article class="reel-tile" aria-label={item.title}>
          <div class="reel-media" data-hover-preview={item.video ? "true" : undefined}>
            <img src={item.image} alt={item.title} loading="lazy" />
            {item.video ? (
              <video class="reel-preview" src={item.video} muted loop playsinline preload="none" aria-hidden="true" />
            ) : null}
          </div>
          <div class="reel-overlay">
            <p class="reel-brand"><span class="reel-dot" aria-hidden="true"></span>matteocurcio</p>
            <p class="reel-title">{item.title}</p>
          </div>
        </article>
      );
    })}
  </section>
</BaseLayout>
