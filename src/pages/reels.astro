---
import BaseLayout from "../layouts/BaseLayout.astro";
import ProjectCard from "../components/ProjectCard.astro";
import { getCollection } from "astro:content";

const all = (await getCollection("projects")).sort((a, b) => b.data.year - a.data.year);

const reels = all.filter((p) => {
  const slug = p.slug.toLowerCase();
  const title = p.data.title.toLowerCase();
  const tags = (p.data.tags || []).map((t) => t.toLowerCase());
  return slug.includes("reel") || title.includes("reel") || tags.includes("reel") || tags.includes("showreel");
});
---

<BaseLayout title="Reels | Matteo Curcio" path="/reels">
  <p class="kicker">Reels</p>
  <h1>Curated reels and highlights.</h1>
  <p class="post-meta">
    This section is focused on reel-style work. In the next iteration I can map it directly to a dedicated “reel”
    category from your source data.
  </p>

  <div class="section projects-grid">
    {reels.length > 0 ? (
      reels.map((project) => (
        <ProjectCard
          slug={project.slug}
          title={project.data.title}
          client={project.data.client}
          year={project.data.year}
          service={project.data.service}
          excerpt={project.data.excerpt}
          cover={project.data.cover}
          coverAlt={project.data.coverAlt}
        />
      ))
    ) : (
      <article class="panel">
        <p>No reel-tagged projects yet. Add `reel` in a project’s `tags` field to show it here.</p>
      </article>
    )}
  </div>
</BaseLayout>
