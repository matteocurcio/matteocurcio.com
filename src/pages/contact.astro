---
import BaseLayout from "../layouts/BaseLayout.astro";
import { CONTACT_MAILTO, SITE_CONFIG } from "../config/site";
---

<BaseLayout
  title="Contact | Matteo Curcio"
  description="Project, studio, and tutoring enquiries with timeline, budget, and delivery details."
  path="/contact"
>
  <p class="kicker">Contact</p>
  <h1>Tell me what you need, and Iâ€™ll reply with a practical next step.</h1>
  <p id="intent-message" class="post-meta">General enquiry form.</p>

  <form class="contact-form" action={CONTACT_MAILTO} method="post" enctype="text/plain">
    <input type="hidden" name="intent" id="intent-field" value="general" />

    <label>
      Name
      <input type="text" name="name" required />
    </label>

    <label>
      Email
      <input type="email" name="email" required />
    </label>

    <label>
      Timeline
      <select name="timeline" required>
        <option value="this-week">This week</option>
        <option value="2-weeks">Within 2 weeks</option>
        <option value="1-month">Within 1 month</option>
        <option value="flexible">Flexible</option>
      </select>
    </label>

    <label>
      Budget Range
      <select name="budget_range" required>
        <option value="under-2k">Under 2k</option>
        <option value="2k-5k">2k - 5k</option>
        <option value="5k-10k">5k - 10k</option>
        <option value="10k-plus">10k+</option>
      </select>
    </label>

    <label>
      Footage & Format
      <input type="text" name="footage_format" placeholder="Camera, resolution, delivery spec" />
    </label>

    <label>
      Review Method
      <select name="review_method">
        <option value="frameio">Frame.io</option>
        <option value="vimeo">Vimeo</option>
        <option value="in-person">In-person</option>
        <option value="other">Other</option>
      </select>
    </label>

    <label>
      Message
      <textarea name="message" rows="6" required></textarea>
    </label>

    <button type="submit">Send</button>
  </form>

  <section class="section">
    <p>Email: <a href={CONTACT_MAILTO}>{SITE_CONFIG.contactEmail}</a></p>
  </section>

  <script>
    const params = new URLSearchParams(window.location.search);
    const intent = (params.get("intent") || "general").toLowerCase();
    const msg = document.getElementById("intent-message");
    const intentField = document.getElementById("intent-field");

    const map = {
      project: "Project enquiry: share goals, schedule, and delivery expectations.",
      studio: "Studio enquiry: describe workflow bottlenecks and current handoff model.",
      tutoring: "Tutoring enquiry: include current level, clips, and learning goals.",
      general: "General enquiry form."
    };

    const safeIntent = map[intent] ? intent : "general";
    if (msg) msg.textContent = map[safeIntent];
    if (intentField) intentField.value = safeIntent;
  </script>
</BaseLayout>
